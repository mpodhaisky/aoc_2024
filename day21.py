import time
from collections import Counter, defaultdict
import hashlib
import re
import math
import heapq
from functools import cache

adj4 = [(-1,0),(0,1),(1,0),(0,-1)]
adj8 = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]

# trans={"U":(-1,0),"L":(0,-1), "D":(1,0),"R":(0,1)}
trans = {(-1,0):"^",(0,1):">",(0,-1):"<",(1,0):"v"}

def nums(line):
    return list(map(int,re.findall(r'-?\d+', line)))

adj1 =  {('7', '7'): [[('A', 'A')]], ('7', '8'): [(('A', '>'), ('>', 'A'))], ('7', '9'): [(('A', '>'), ('>', '>'), ('>', 'A'))], ('7', '4'): [(('A', 'v'), ('v', 'A'))], ('7', '5'): [(('A', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'A'))], ('7', '6'): [(('A', '>'), ('>', '>'), ('>', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', '>'), ('>', 'A')), (('A', 'v'), ('v', '>'), ('>', '>'), ('>', 'A'))], ('7', '1'): [(('A', 'v'), ('v', 'v'), ('v', 'A'))], ('7', '2'): [(('A', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A'))], ('7', '3'): [(('A', '>'), ('>', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A')), (('A', 'v'), ('v', '>'), ('>', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', '>'), ('>', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', '>'), ('>', 'A'))], ('7', '0'): [(('A', '>'), ('>', 'v'), ('v', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A'))], ('7', 'A'): [(('A', '>'), ('>', '>'), ('>', 'v'), ('v', 'v'), ('v', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A')), (('A', 'v'), ('v', '>'), ('>', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', 'v'), ('v', '>'), ('>', 'A'))], ('8', '7'): [(('A', '<'), ('<', 'A'))], ('8', '8'): [[('A', 'A')]], ('8', '9'): [(('A', '>'), ('>', 'A'))], ('8', '4'): [(('A', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', 'A'))], ('8', '5'): [(('A', 'v'), ('v', 'A'))], ('8', '6'): [(('A', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'A'))], ('8', '1'): [(('A', 'v'), ('v', 'v'), ('v', '<'), ('<', 'A')), (('A', 'v'), ('v', '<'), ('<', 'v'), ('v', 'A')), (('A', '<'), ('<', 'v'), ('v', 'v'), ('v', 'A'))], ('8', '2'): [(('A', 'v'), ('v', 'v'), ('v', 'A'))], ('8', '3'): [(('A', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A'))], ('8', '0'): [(('A', 'v'), ('v', 'v'), ('v', 'v'), ('v', 'A'))], ('8', 'A'): [(('A', '>'), ('>', 'v'), ('v', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A'))], ('9', '7'): [(('A', '<'), ('<', '<'), ('<', 'A'))], ('9', '8'): [(('A', '<'), ('<', 'A'))], ('9', '9'): [[('A', 'A')]], ('9', '4'): [(('A', 'v'), ('v', '<'), ('<', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', '<'), ('<', 'v'), ('v', 'A'))], ('9', '5'): [(('A', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', 'A'))], ('9', '6'): [(('A', 'v'), ('v', 'A'))], ('9', '1'): [(('A', 'v'), ('v', 'v'), ('v', '<'), ('<', '<'), ('<', 'A')), (('A', 'v'), ('v', '<'), ('<', 'v'), ('v', '<'), ('<', 'A')), (('A', 'v'), ('v', '<'), ('<', '<'), ('<', 'v'), ('v', 'A')), (('A', '<'), ('<', 'v'), ('v', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', '<'), ('<', 'v'), ('v', 'A')), (('A', '<'), ('<', '<'), ('<', 'v'), ('v', 'v'), ('v', 'A'))], ('9', '2'): [(('A', 'v'), ('v', 'v'), ('v', '<'), ('<', 'A')), (('A', 'v'), ('v', '<'), ('<', 'v'), ('v', 'A')), (('A', '<'), ('<', 'v'), ('v', 'v'), ('v', 'A'))], ('9', '3'): [(('A', 'v'), ('v', 'v'), ('v', 'A'))], ('9', '0'): [(('A', 'v'), ('v', 'v'), ('v', 'v'), ('v', '<'), ('<', 'A')), (('A', 'v'), ('v', 'v'), ('v', '<'), ('<', 'v'), ('v', 'A')), (('A', 'v'), ('v', '<'), ('<', 'v'), ('v', 'v'), ('v', 'A')), (('A', '<'), ('<', 'v'), ('v', 'v'), ('v', 'v'), ('v', 'A'))], ('9', 'A'): [(('A', 'v'), ('v', 'v'), ('v', 'v'), ('v', 'A'))], ('4', '7'): [(('A', '^'), ('^', 'A'))], ('4', '8'): [(('A', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', 'A'))], ('4', '9'): [(('A', '^'), ('^', '>'), ('>', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '>'), ('>', '^'), ('^', 'A'))], ('4', '4'): [[('A', 'A')]], ('4', '5'): [(('A', '>'), ('>', 'A'))], ('4', '6'): [(('A', '>'), ('>', '>'), ('>', 'A'))], ('4', '1'): [(('A', 'v'), ('v', 'A'))], ('4', '2'): [(('A', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'A'))], ('4', '3'): [(('A', '>'), ('>', '>'), ('>', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', '>'), ('>', 'A')), (('A', 'v'), ('v', '>'), ('>', '>'), ('>', 'A'))], ('4', '0'): [(('A', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A'))], ('4', 'A'): [(('A', '>'), ('>', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A')), (('A', 'v'), ('v', '>'), ('>', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', '>'), ('>', 'A'))], ('5', '7'): [(('A', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', 'A'))], ('5', '8'): [(('A', '^'), ('^', 'A'))], ('5', '9'): [(('A', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', 'A'))], ('5', '4'): [(('A', '<'), ('<', 'A'))], ('5', '5'): [[('A', 'A')]], ('5', '6'): [(('A', '>'), ('>', 'A'))], ('5', '1'): [(('A', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', 'A'))], ('5', '2'): [(('A', 'v'), ('v', 'A'))], ('5', '3'): [(('A', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'A'))], ('5', '0'): [(('A', 'v'), ('v', 'v'), ('v', 'A'))], ('5', 'A'): [(('A', '>'), ('>', 'v'), ('v', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', 'v'), ('v', '>'), ('>', 'A'))], ('6', '7'): [(('A', '^'), ('^', '<'), ('<', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '<'), ('<', '^'), ('^', 'A'))], ('6', '8'): [(('A', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', 'A'))], ('6', '9'): [(('A', '^'), ('^', 'A'))], ('6', '4'): [(('A', '<'), ('<', '<'), ('<', 'A'))], ('6', '5'): [(('A', '<'), ('<', 'A'))], ('6', '6'): [[('A', 'A')]], ('6', '1'): [(('A', 'v'), ('v', '<'), ('<', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', '<'), ('<', 'v'), ('v', 'A'))], ('6', '2'): [(('A', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', 'A'))], ('6', '3'): [(('A', 'v'), ('v', 'A'))], ('6', '0'): [(('A', 'v'), ('v', 'v'), ('v', '<'), ('<', 'A')), (('A', 'v'), ('v', '<'), ('<', 'v'), ('v', 'A')), (('A', '<'), ('<', 'v'), ('v', 'v'), ('v', 'A'))], ('6', 'A'): [(('A', 'v'), ('v', 'v'), ('v', 'A'))], ('1', '7'): [(('A', '^'), ('^', '^'), ('^', 'A'))], ('1', '8'): [(('A', '^'), ('^', '^'), ('^', '>'), ('>', 'A')), (('A', '^'), ('^', '>'), ('>', '^'), ('^', 'A')), (('A', '>'), ('>', '^'), ('^', '^'), ('^', 'A'))], ('1', '9'): [(('A', '^'), ('^', '^'), ('^', '>'), ('>', '>'), ('>', 'A')), (('A', '^'), ('^', '>'), ('>', '^'), ('^', '>'), ('>', 'A')), (('A', '^'), ('^', '>'), ('>', '>'), ('>', '^'), ('^', 'A')), (('A', '>'), ('>', '^'), ('^', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', '>'), ('>', '^'), ('^', 'A')), (('A', '>'), ('>', '>'), ('>', '^'), ('^', '^'), ('^', 'A'))], ('1', '4'): [(('A', '^'), ('^', 'A'))], ('1', '5'): [(('A', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', 'A'))], ('1', '6'): [(('A', '^'), ('^', '>'), ('>', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '>'), ('>', '^'), ('^', 'A'))], ('1', '1'): [[('A', 'A')]], ('1', '2'): [(('A', '>'), ('>', 'A'))], ('1', '3'): [(('A', '>'), ('>', '>'), ('>', 'A'))], ('1', '0'): [(('A', '>'), ('>', 'v'), ('v', 'A'))], ('1', 'A'): [(('A', '>'), ('>', '>'), ('>', 'v'), ('v', 'A')), (('A', '>'), ('>', 'v'), ('v', '>'), ('>', 'A'))], ('2', '7'): [(('A', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', 'A'))], ('2', '8'): [(('A', '^'), ('^', '^'), ('^', 'A'))], ('2', '9'): [(('A', '^'), ('^', '^'), ('^', '>'), ('>', 'A')), (('A', '^'), ('^', '>'), ('>', '^'), ('^', 'A')), (('A', '>'), ('>', '^'), ('^', '^'), ('^', 'A'))], ('2', '4'): [(('A', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', 'A'))], ('2', '5'): [(('A', '^'), ('^', 'A'))], ('2', '6'): [(('A', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', 'A'))], ('2', '1'): [(('A', '<'), ('<', 'A'))], ('2', '2'): [[('A', 'A')]], ('2', '3'): [(('A', '>'), ('>', 'A'))], ('2', '0'): [(('A', 'v'), ('v', 'A'))], ('2', 'A'): [(('A', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'A'))], ('3', '7'): [(('A', '^'), ('^', '^'), ('^', '<'), ('<', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '<'), ('<', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '<'), ('<', '<'), ('<', '^'), ('^', '^'), ('^', 'A'))], ('3', '8'): [(('A', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', 'A'))], ('3', '9'): [(('A', '^'), ('^', '^'), ('^', 'A'))], ('3', '4'): [(('A', '^'), ('^', '<'), ('<', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '<'), ('<', '^'), ('^', 'A'))], ('3', '5'): [(('A', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', 'A'))], ('3', '6'): [(('A', '^'), ('^', 'A'))], ('3', '1'): [(('A', '<'), ('<', '<'), ('<', 'A'))], ('3', '2'): [(('A', '<'), ('<', 'A'))], ('3', '3'): [[('A', 'A')]], ('3', '0'): [(('A', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', 'A'))], ('3', 'A'): [(('A', 'v'), ('v', 'A'))], ('0', '7'): [(('A', '^'), ('^', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', '^'), ('^', 'A'))], ('0', '8'): [(('A', '^'), ('^', '^'), ('^', '^'), ('^', 'A'))], ('0', '9'): [(('A', '^'), ('^', '^'), ('^', '^'), ('^', '>'), ('>', 'A')), (('A', '^'), ('^', '^'), ('^', '>'), ('>', '^'), ('^', 'A')), (('A', '^'), ('^', '>'), ('>', '^'), ('^', '^'), ('^', 'A')), (('A', '>'), ('>', '^'), ('^', '^'), ('^', '^'), ('^', 'A'))], ('0', '4'): [(('A', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', 'A'))], ('0', '5'): [(('A', '^'), ('^', '^'), ('^', 'A'))], ('0', '6'): [(('A', '^'), ('^', '^'), ('^', '>'), ('>', 'A')), (('A', '^'), ('^', '>'), ('>', '^'), ('^', 'A')), (('A', '>'), ('>', '^'), ('^', '^'), ('^', 'A'))], ('0', '1'): [(('A', '^'), ('^', '<'), ('<', 'A'))], ('0', '2'): [(('A', '^'), ('^', 'A'))], ('0', '3'): [(('A', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', 'A'))], ('0', '0'): [[('A', 'A')]], ('0', 'A'): [(('A', '>'), ('>', 'A'))], ('A', '7'): [(('A', '^'), ('^', '^'), ('^', '^'), ('^', '<'), ('<', '<'), ('<', 'A')), (('A', '^'), ('^', '^'), ('^', '<'), ('<', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '^'), ('^', '<'), ('<', '<'), ('<', '^'), ('^', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '^'), ('^', '<'), ('<', '<'), ('<', '^'), ('^', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '<'), ('<', '^'), ('^', '^'), ('^', 'A'))], ('A', '8'): [(('A', '^'), ('^', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', '^'), ('^', 'A'))], ('A', '9'): [(('A', '^'), ('^', '^'), ('^', '^'), ('^', 'A'))], ('A', '4'): [(('A', '^'), ('^', '^'), ('^', '<'), ('<', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '<'), ('<', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', '<'), ('<', '^'), ('^', 'A'))], ('A', '5'): [(('A', '^'), ('^', '^'), ('^', '<'), ('<', 'A')), (('A', '^'), ('^', '<'), ('<', '^'), ('^', 'A')), (('A', '<'), ('<', '^'), ('^', '^'), ('^', 'A'))], ('A', '6'): [(('A', '^'), ('^', '^'), ('^', 'A'))], ('A', '1'): [(('A', '^'), ('^', '<'), ('<', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', '<'), ('<', 'A'))], ('A', '2'): [(('A', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', 'A'))], ('A', '3'): [(('A', '^'), ('^', 'A'))], ('A', '0'): [(('A', '<'), ('<', 'A'))], ('A', 'A'): [[('A', 'A')]]}
adj2 =  {('^', '^'): [[('A', 'A')]], ('^', 'A'): [(('A', '>'), ('>', 'A'))], ('^', '<'): [(('A', 'v'), ('v', '<'), ('<', 'A'))], ('^', 'v'): [(('A', 'v'), ('v', 'A'))], ('^', '>'): [(('A', '>'), ('>', 'v'), ('v', 'A')), (('A', 'v'), ('v', '>'), ('>', 'A'))], ('A', '^'): [(('A', '<'), ('<', 'A'))], ('A', 'A'): [[('A', 'A')]], ('A', '<'): [(('A', 'v'), ('v', '<'), ('<', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', '<'), ('<', 'A'))], ('A', 'v'): [(('A', 'v'), ('v', '<'), ('<', 'A')), (('A', '<'), ('<', 'v'), ('v', 'A'))], ('A', '>'): [(('A', 'v'), ('v', 'A'))], ('<', '^'): [(('A', '>'), ('>', '^'), ('^', 'A'))], ('<', 'A'): [(('A', '>'), ('>', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '>'), ('>', '^'), ('^', 'A'))], ('<', '<'): [[('A', 'A')]], ('<', 'v'): [(('A', '>'), ('>', 'A'))], ('<', '>'): [(('A', '>'), ('>', '>'), ('>', 'A'))], ('v', '^'): [(('A', '^'), ('^', 'A'))], ('v', 'A'): [(('A', '^'), ('^', '>'), ('>', 'A')), (('A', '>'), ('>', '^'), ('^', 'A'))], ('v', '<'): [(('A', '<'), ('<', 'A'))], ('v', 'v'): [[('A', 'A')]], ('v', '>'): [(('A', '>'), ('>', 'A'))], ('>', '^'): [(('A', '^'), ('^', '<'), ('<', 'A')), (('A', '<'), ('<', '^'), ('^', 'A'))], ('>', 'A'): [(('A', '^'), ('^', 'A'))], ('>', '<'): [(('A', '<'), ('<', '<'), ('<', 'A'))], ('>', 'v'): [(('A', '<'), ('<', 'A'))], ('>', '>'): [[('A', 'A')]]}

def part1(data):
    dp={n: 1 for n in adj2}

    for _ in range(2):
        tmp=dp.copy()
        for n in dp:
            dp[n] = min(sum(tmp[k] for k in m) for m in adj2[n])

    total=0
    for line in data.split("\n"):
        cur=0
        for a,b in zip("A"+line,line):
            cur+=min(sum(dp[k] for k in m) for m in adj1[(a,b)])
        total+=cur*int(line[:-1])
    return total
        
def part2(data):
    dp={n: 1 for n in adj2}
    for _ in range(25):
        tmp=dp.copy()
        for n in dp:
            dp[n] = min(sum(tmp[k] for k in m) for m in adj2[n])

    total=0
    for line in data.split("\n"):
        cur=0
        for a,b in zip("A"+line,line):
            cur+=min(sum(dp[k] for k in m) for m in adj1[(a,b)])
        total+=cur*int(line[:-1])
    return total

if __name__ == "__main__":
    data = open(0).read().rstrip()
    t1 = time.time()
    res1 = part1(data)
    t2 = time.time()
    res2 = part2(data)
    t3 = time.time()
    print("----------------Part 1-----------------")
    print(f"time: {(t2-t1)*1000}".split(".")[0] + " ms")
    print(f"flag: {res1}")
    print("----------------Part 2-----------------")
    print(f"time: {(t3-t2)*1000}".split(".")[0] + " ms")
    print(f"flag: {res2}")

